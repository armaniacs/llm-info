# プロダクトバックログアイテム: Needle In A Haystack機能

**作成日**: 2026-01-11
**更新日**: 2026-01-11
**ステータス**: Backlog（v2.1以降）
**ランク**: 13

## 親PBI
PBI-2-0-001: v2.0モデル制約値推定機能

## ユーザーストーリー

開発者として、検証用キーワードの埋め込み位置を指定したい、なぜならContext Window探索の信頼性を高め、「ロスト・イン・ザ・ミドル」現象を検証したいから

## ビジネス価値

- **信頼性向上**: 実用的なコンテキスト容量を正確に測定
- **品質保証**: モデルの実効性能を検証
- **ベンチマーク**: 標準的なNIAH手法でモデルを評価
- **詳細分析**: 位置依存の性能特性を把握

## 機能概要

### --needle-position フラグ

```bash
# 文末（デフォルト）
llm-info probe-context --model GLM-4.6 --needle-position end

# 文の中央（ロスト・イン・ザ・ミドル検証）
llm-info probe-context --model GLM-4.6 --needle-position middle

# 全体の80%位置（実用的な限界値）
llm-info probe-context --model GLM-4.6 --needle-position 80pct
```

### 位置の定義
- `end`: テキスト末尾（最も簡単）
- `middle`: テキストの50%位置（最も難しい）
- `80pct`: テキストの80%位置（実用的）

### テストデータ構造
```
[Preamble] + [Body] + [Needle at position X] + [Body] + [Question]
```

## 受け入れ基準（Draft）

- [ ] 3つの位置（end/middle/80pct）をサポート
- [ ] 各位置で正しくキーワードが埋め込まれる
- [ ] 位置による性能差を検出できる
- [ ] 結果に位置情報が含まれる

## 見積もり

**ストーリーポイント**: 3（約6時間）

## v2.0で延期した理由

- 基本的な探索機能の安定化を優先
- NIAHは高度な検証機能であり、v2.0の必須要件ではない
- 実装と検証に時間がかかる

## v2.1での優先順位

中（研究やベンチマーク用途では有用）
