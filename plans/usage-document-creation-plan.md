# USAGE.md 作成計画

## プロジェクト情報

**対象プロジェクト**: llm-info
**プロジェクトタイプ**: CLIツール（Go言語製）
**目的**: LiteLLM互換ゲートウェイからモデル情報を取得して表示
**現在のステータス**: MVP完了（2026-01-08）

## ドキュメント要件

### 対象読者
- **開発者（コントリビューター）**: プロジェクトに貢献したい開発者
- **エンドユーザー**: ツールを使いたい一般ユーザー

### 詳細レベル
- **中間レベル**: 基本的な使い方と主要機能を説明し、高度な機能は別ドキュメントへ誘導

### 含めるセクション
- インストール手順
- 基本的な使い方

## 現在のプロジェクト構造

```
llm-info/
├── cmd/llm-info/main.go         # CLIエントリーポイント
├── internal/
│   ├── api/                     # API通信層
│   ├── config/                  # 設定管理
│   ├── model/                   # データモデル
│   └── ui/                      # テーブル表示
├── test/integration/            # 統合テスト
├── Makefile                     # ビルド自動化
├── README.md                    # 包括的なドキュメント
└── go.mod                       # Go依存関係
```

## 実装済み機能

### コア機能
1. **モデル情報取得**: LiteLLM互換`/model/info`エンドポイントからデータ取得
2. **テーブル表示**: 動的な列制御で整形されたテーブル表示
3. **認証対応**: APIキー認証をサポート
4. **タイムアウト設定**: カスタマイズ可能なタイムアウト
5. **エラーハンドリング**: 詳細なエラーメッセージと解決策の提示

### コマンドラインオプション
- `--url`: ゲートウェイのベースURL（必須）
- `--api-key`: 認証用APIキー（オプション）
- `--timeout`: リクエストタイムアウト（デフォルト: 10s）
- `--help`: ヘルプメッセージ表示

### ビルドシステム
- Makefileによる自動化
- ターゲット: build, test, test-coverage, clean, lint, install, run-example

## USAGE.md の構成案

### 1. 概要セクション
- **目的**: llm-infoの簡潔な説明（1-2文）
- **内容**:
  - LiteLLM互換ゲートウェイからモデル情報を取得するCLIツール
  - シンプルで使いやすいインターフェース

### 2. クイックスタート
- **目的**: 最速で使い始めるための最小限の手順
- **内容**:
  ```bash
  # ビルド
  make build

  # 実行
  ./bin/llm-info --url https://gateway.example.com/v1
  ```

### 3. インストール
- **3.1 前提条件**
  - Go 1.21以上
  - Git
  - Make（オプション、手動ビルドも可能）

- **3.2 ソースからビルド**
  ```bash
  git clone https://github.com/your-org/llm-info.git
  cd llm-info
  make build
  ```

- **3.3 Goインストール**（将来的に公開する場合）
  ```bash
  go install github.com/your-org/llm-info/cmd/llm-info@latest
  ```

- **3.4 バイナリのインストール**（オプション）
  ```bash
  make install
  ```

### 4. 基本的な使い方

- **4.1 最もシンプルな使用例**
  ```bash
  llm-info --url https://gateway.aipf-dev.sakuraha.jp/v1
  ```
  - 出力例の提示
  - 各列の意味の説明

- **4.2 APIキーを使用する場合**
  ```bash
  llm-info --url https://gateway.example.com/v1 --api-key your-api-key
  ```
  - APIキーの取得方法（一般的な説明）
  - 環境変数での管理推奨（将来の拡張機能として）

- **4.3 タイムアウトのカスタマイズ**
  ```bash
  llm-info --url https://gateway.example.com/v1 --timeout 30s
  ```
  - タイムアウト値の形式説明（10s, 1m, etc.）
  - デフォルト値の明記（10s）

- **4.4 ヘルプの表示**
  ```bash
  llm-info --help
  ```

### 5. 出力の見方

- **テーブル列の説明**
  - **Model Name**: モデルの識別子
  - **Max Tokens**: モデルの最大トークン数
  - **Mode**: モデルのモード（chat, completion, etc.）
  - **Input Cost**: 入力トークンあたりのコスト

- **動的列制御**
  - 利用可能なデータに応じて列が自動調整される
  - すべての列が常に表示されるわけではない

### 6. よくあるユースケース

- **6.1 複数ゲートウェイの情報を取得**
  ```bash
  llm-info --url https://gateway1.example.com/v1
  llm-info --url https://gateway2.example.com/v1
  ```

- **6.2 スクリプトでの使用**
  ```bash
  #!/bin/bash
  GATEWAY_URL="https://gateway.example.com/v1"
  API_KEY="your-api-key"

  llm-info --url "$GATEWAY_URL" --api-key "$API_KEY"
  ```

### 7. トラブルシューティング

- **接続エラー**
  - 症状: "connection refused"
  - 原因: URLが間違っている、ゲートウェイが停止している
  - 解決策: URL確認、ゲートウェイ稼働確認

- **認証エラー**
  - 症状: "401 Unauthorized"
  - 原因: APIキーが間違っている
  - 解決策: APIキーの再確認

- **タイムアウトエラー**
  - 症状: "timeout"
  - 原因: ネットワーク遅延、ゲートウェイ応答遅延
  - 解決策: `--timeout`フラグで時間延長

- **エンドポイント未対応**
  - 症状: "404 Not Found"
  - 原因: ゲートウェイがLiteLLM互換でない
  - 解決策: 対応ゲートウェイの使用

### 8. 開発者向け情報（コントリビューター向け）

- **8.1 開発環境のセットアップ**
  ```bash
  git clone https://github.com/your-org/llm-info.git
  cd llm-info
  go mod download
  ```

- **8.2 テストの実行**
  ```bash
  make test              # 単体テスト
  make test-coverage     # カバレッジ付きテスト
  ```

- **8.3 ビルドターゲット**
  - `make build`: バイナリビルド
  - `make test`: テスト実行
  - `make lint`: コード品質チェック
  - `make clean`: クリーンアップ
  - `make help`: ヘルプ表示

- **8.4 貢献方法**
  - Issue報告
  - プルリクエスト
  - README.mdやCONTRIBUTING.mdへのリンク

### 9. 詳細情報へのリンク

- **README.md**: 包括的なプロジェクト情報
- **API仕様**: LiteLLM互換エンドポイント仕様
- **将来の機能**: ロードマップへのリンク

## README.mdとの差別化

| セクション | README.md | USAGE.md |
|----------|-----------|----------|
| **目的** | プロジェクト全体の概要 | 使い方に特化 |
| **対象読者** | 幅広い（開発者、ユーザー、コントリビューター） | ユーザーと貢献者 |
| **インストール** | 簡潔な手順 | 詳細な手順と前提条件 |
| **使用例** | 基本例のみ | 複数のユースケース |
| **トラブルシューティング** | 簡単な対処法 | 詳細な診断と解決策 |
| **開発情報** | プロジェクト構造、テスト | セットアップ手順、貢献方法 |

## 作成ステップ

### Phase 1: 準備
1. **既存ドキュメントのレビュー**
   - [README.md](../README.md)を読み、重複を避ける
   - [mvp-implementation-plan.md](mvp-implementation-plan.md)で実装詳細を確認
   - [Makefile](../Makefile)でビルドコマンドを確認

2. **実行例の準備**
   - 実際にツールを実行してスクリーンショット/出力例を取得
   - エラーケースの出力例も収集

### Phase 2: ドキュメント作成
1. **概要セクション作成**
   - 1-2文でツールの目的を説明
   - ターゲットユーザーを明示

2. **クイックスタート作成**
   - 最小限のコマンドで動作する例
   - コピー&ペーストで実行可能

3. **インストール手順作成**
   - ステップバイステップの手順
   - 各オプションの説明

4. **基本的な使い方作成**
   - 主要なユースケースをカバー
   - 実行例と出力例を含む

5. **トラブルシューティング作成**
   - 実際のエラーメッセージ
   - 具体的な解決策

6. **開発者向け情報作成**
   - セットアップ手順
   - テスト実行方法
   - 貢献ガイドライン

### Phase 3: レビューと改善
1. **内部レビュー**
   - 技術的正確性の確認
   - コマンド例の動作確認

2. **ユーザビリティチェック**
   - 初心者でも理解できるか
   - ステップが明確か

3. **一貫性チェック**
   - README.mdとの整合性
   - 用語の統一

## 重要なポイント

### Do's
- ✅ 実際に動作するコマンド例を提供
- ✅ 出力例を含める
- ✅ エラーメッセージと解決策をペアで提示
- ✅ 初心者でも理解できる言葉遣い
- ✅ README.mdと相互リンク

### Don'ts
- ❌ README.mdの内容を完全に複製
- ❌ 技術的すぎる詳細（実装の詳細は開発者ドキュメントへ）
- ❌ 将来の機能を現在の機能として説明
- ❌ 検証していないコマンド例

## 参照ファイル

作成時に参照すべきファイル:
- [README.md](../README.md) - 既存の説明との整合性確認
- [cmd/llm-info/main.go](../cmd/llm-info/main.go) - CLIオプション、エラーメッセージ
- [Makefile](../Makefile) - ビルドコマンド
- [internal/ui/table.go](../internal/ui/table.go) - 出力形式の理解
- [go.mod](../go.mod) - Go バージョン要件

## 成果物

**ファイル名**: `USAGE.md`
**配置場所**: プロジェクトルート
**推定文量**: 約500-800行
**フォーマット**: Markdown（GitHub flavored）

## 検証方法

作成後、以下を確認:
1. すべてのコマンド例が実際に動作するか
2. エラーケースが実際のエラーと一致するか
3. README.mdとの重複がないか
4. 初心者が迷わず実行できるか
5. 開発者が貢献方法を理解できるか

## 実施状況

### 完了日時
2026-01-08

### 実施内容

#### Phase 1: 準備
- [x] 既存ドキュメントのレビュー
  - README.mdを読み、重複を避ける
  - mvp-implementation-plan.mdで実装詳細を確認
  - Makefileでビルドコマンドを確認
- [x] 実行例の準備
  - 実際にツールを実行して出力例を取得
  - エラーケースの出力例も収集

#### Phase 2: ドキュメント作成
- [x] 概要セクション作成
  - 1-2文でツールの目的を説明
  - ターゲットユーザーを明示
- [x] クイックスタート作成
  - 最小限のコマンドで動作する例
  - コピー&ペーストで実行可能
- [x] インストール手順作成
  - ステップバイステップの手順
  - 各オプションの説明
- [x] 基本的な使い方作成
  - 主要なユースケースをカバー
  - 実行例と出力例を含む
- [x] トラブルシューティング作成
  - 実際のエラーメッセージ
  - 具体的な解決策
- [x] 開発者向け情報作成
  - セットアップ手順
  - テスト実行方法
  - 貢献ガイドライン

#### Phase 3: レビューと改善
- [x] 内部レビュー
  - 技術的正確性の確認
  - コマンド例の動作確認
- [x] ユーザビリティチェック
  - 初心者でも理解できるか
  - ステップが明確か
- [x] 一貫性チェック
  - README.mdとの整合性
  - 用語の統一

### 成果物
- [x] USAGE.mdを作成（プロジェクトルートに配置）
- [x] README.mdにUSAGE.mdへのリンクを追加
- [x] USAGE.mdにREADME.mdへのリンクを追加

### 検証結果
1. [x] すべてのコマンド例が実際に動作する
2. [x] エラーケースが実際のエラーと一致する
3. [x] README.mdとの重複がない
4. [x] 初心者が迷わず実行できる
5. [x] 開発者が貢献方法を理解できる

### 特記事項
- 計画通りにすべてのセクションを作成完了
- README.mdとの相互リンクを追加してナビゲーションを改善
- 実際のコードベースを参照して正確な情報を記載
- よくある質問セクションを追加して利便性を向上

## 次のステップ

このプランに基づいて、以下の順序でUSAGE.mdを作成:
1. [x] 構成案に従ってセクションを作成
2. [x] 各セクションに実際のコマンド例と出力例を追加
3. [x] トラブルシューティングセクションを充実
4. [x] 開発者向け情報を追加
5. [x] 最終レビューとリンク確認

### 今後の改善案
- ユーザーフィードバックに基づく内容の改善
- 新機能追加時のドキュメント更新
- より多くの実行例の追加
